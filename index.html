<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ã‚‰ã„ã‚€ã®æ­Œãˆã‚‹æ›²ãƒªã‚¹ãƒˆ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    /* ======================
       ãƒ™ãƒ¼ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«
    ======================= */
    :root {
      --bg: #f3f4ff;
      --bg-card: #ffffff;
      --accent: #6366f1;
      --accent-soft: rgba(99, 102, 241, 0.12);
      --text-main: #111827;
      --text-sub: #6b7280;
      --border: #e5e7eb;
      --radius-lg: 16px;
      --shadow-soft: 0 10px 30px rgba(15, 23, 42, 0.08);
    }

    * {
      box-sizing: border-box;
    }

    body {
        margin: 0;
        padding: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
            sans-serif;
        color: var(--text-main);
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
        background: #000; /* ç”»åƒèª­ã¿è¾¼ã¿å‰ã®ä¸€æ™‚èƒŒæ™¯ */
        }

        body::before {
            content: "";
            position: fixed;
            inset: 0;
            background: url("./bg.jpg") center center / cover no-repeat;
            filter: blur(10px) brightness(0.85);
            transform: scale(1.05);
            z-index: -2;
        }


        /* ã»ã‚“ã®ã‚Šã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‘ã¦è¦‹ã‚„ã™ãã™ã‚‹ */
        body::after {
        content: "";
        position: fixed;
        inset: 0;
        background: radial-gradient(circle at top, rgba(99, 102, 241, 0.18), transparent 55%);
        z-index: -1;
        }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 12px 16px 32px;
    }

    /* ======================
       ãƒ˜ãƒƒãƒ€ãƒ¼
    ======================= */
    header {
      position: sticky;
      top: 0;
      z-index: 20;
      padding: 12px 0 10px;
      margin-bottom: 10px;
      backdrop-filter: blur(16px);
    }

    .header-inner {
      background: rgba(255, 255, 255, 0.92);
      border-radius: 24px;
      padding: 10px 14px 12px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.25);
    }

    .title-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
      flex-wrap: wrap;
      justify-content: center;
    }

    h1 {
      font-size: 1.3rem;
      margin: 0;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 0.25em;
    }

    .title-chip {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: var(--accent-soft);
      color: var(--accent);
      border: 1px solid rgba(129, 140, 248, 0.6);
    }

    .tagline {
      font-size: 0.85rem;
      color: var(--text-sub);
      text-align: center;
    }

    .note {
      font-size: 0.75rem;
      color: #9ca3af;
      text-align: center;
      margin-top: 2px;
    }

    /* ======================
       æ¤œç´¢ & ãƒ•ã‚£ãƒ«ã‚¿
    ======================= */
    .controls {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .search-box label {
      font-size: 0.8rem;
      color: var(--text-sub);
      display: block;
      margin-bottom: 4px;
    }

    .search-input-wrap {
      position: relative;
    }

    .search-box input {
      width: 100%;
      padding: 9px 12px 9px 32px;
      font-size: 0.95rem;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      outline: none;
      background: #f9fafb;
    }

    .search-box input:focus {
      border-color: var(--accent);
      background: #ffffff;
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.9rem;
      color: #9ca3af;
      pointer-events: none;
    }

    .filter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 2px;
      justify-content: center;
    }

    .filter-btn {
      border: none;
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 0.78rem;
      background: rgba(255, 255, 255, 0.9);
      color: var(--text-sub);
      cursor: pointer;
      border: 1px solid rgba(209, 213, 219, 0.9);
      display: flex;
      align-items: center;
      gap: 4px;
      transition: background 0.15s, color 0.15s, border-color 0.15s, transform 0.05s;
    }

    .filter-btn span.count {
      font-size: 0.7rem;
      padding: 0 4px;
      border-radius: 999px;
      background: #e5e7eb;
      color: #4b5563;
    }

    .filter-btn.active {
      background: var(--accent);
      color: #ffffff;
      border-color: var(--accent);
    }

    .filter-btn.active span.count {
      background: rgba(248, 250, 252, 0.2);
      color: #e5e7eb;
    }

    .filter-btn:active {
      transform: translateY(1px);
    }

    /* ======================
       ã‚»ã‚¯ã‚·ãƒ§ãƒ³ & ãƒ†ãƒ¼ãƒ–ãƒ«
    ======================= */
    main {
      margin-top: 12px;
    }

    .category-section {
      margin-top: 18px;
    }

    .category-header {
      display: flex;
      align-items: baseline;
      gap: 6px;
      margin-bottom: 6px;
    }

    .category-title {
      font-size: 1rem;
      margin: 0;
      padding-left: 8px;
      border-left: 4px solid var(--accent);
    }

    .category-badge {
      font-size: 0.7rem;
      color: var(--text-sub);
    }

    .table-wrapper {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 6px 6px 4px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.35);
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
      min-width: 320px;
    }

    th,
    td {
      padding: 6px 8px;
      text-align: left;
      vertical-align: top;
      border-bottom: 1px solid var(--border);
    }

    th {
      font-size: 0.75rem;
      background: #f9fafb;
      color: #6b7280;
      white-space: nowrap;
    }

    tr:last-child td {
      border-bottom: none;
    }

    .song-title {
      font-weight: 600;
    }

    .song-artist {
      color: #4b5563;
      font-size: 0.88rem;
    }

    .memo-pill {
      display: inline-flex;
      align-items: center;
      padding: 1px 6px;
      border-radius: 999px;
      font-size: 0.72rem;
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: #4b5563;
      background: #f9fafb;
    }

    .memo-pill.memo-ng {
      border-color: #f87171;
      background: #fef2f2;
      color: #b91c1c;
    }

    .memo-pill.memo-training {
      border-color: #38bdf8;
      background: #ecfeff;
      color: #0369a1;
    }

    .memo-pill.memo-key {
      border-color: #a855f7;
      background: #faf5ff;
      color: #7e22ce;
    }

    .memo-text {
      font-size: 0.8rem;
      color: #4b5563;
    }

    .empty-msg {
      margin-top: 24px;
      text-align: center;
      font-size: 0.85rem;
      color: var(--text-sub);
    }

    /* ======================
       ãƒ•ãƒƒã‚¿ãƒ¼
    ======================= */
    footer {
      margin-top: 24px;
      text-align: center;
      font-size: 0.72rem;
      color: #9ca3af;
    }

    /* ======================
       ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–
    ======================= */
    @media (max-width: 600px) {
      h1 {
        font-size: 1.15rem;
      }

      .title-row {
        justify-content: center;
      }

      table {
        font-size: 0.85rem;
      }

      th,
      td {
        padding: 6px 6px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-inner">
        <div class="title-row">
          <h1>ã‚‰ã„ã‚€ã®æ­Œãˆã‚‹æ›²ãƒªã‚¹ãƒˆ <span>ğŸ¤</span></h1>
          <span class="title-chip">ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ­“è¿</span>
        </div>
        <div class="tagline">
          é…ä¿¡ã§æ­Œãˆã‚‹ï¼ˆæ­Œã„ãŸã„ï¼‰æ›²ã‚’ã¾ã¨ã‚ãŸãƒšãƒ¼ã‚¸ã§ã™ã€‚
        </div>
        <div class="note">æ›²åãƒ»ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆãƒ»ãƒ¡ãƒ¢ã§æ¤œç´¢ã§ãã¾ã™</div>

        <div class="controls">
          <div class="search-box">
            <label for="searchInput">æ¤œç´¢ï¼ˆä¾‹ï¼šAdo / ã‚·ãƒ£ãƒ«ãƒ« / ãƒœã‚«ãƒ­ / ç·´ç¿’ä¸­ ãªã©ï¼‰</label>
            <div class="search-input-wrap">
              <span class="search-icon">ğŸ”</span>
              <input
                type="text"
                id="searchInput"
                placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§çµã‚Šè¾¼ã¿..."
              />
            </div>
          </div>

          <div class="filter-row" id="filterRow">
            <!-- JSã§ãƒœã‚¿ãƒ³ã‚’å·®ã—è¾¼ã‚€ -->
          </div>
        </div>
      </div>
    </header>

    <main id="songSections">
      <!-- JSã§ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®ãƒªã‚¹ãƒˆã‚’æç”» -->
    </main>

    <footer>
      æ›´æ–°æ—¥: <span id="updatedDate"></span><br />
      â€» å°‘ã—ãšã¤æ›²ã‚’è¿½åŠ ï¼†æ•´ç†ã—ã¦ã„ãã¾ã™
    </footer>
  </div>

  <script>
    // ======================
    // ã‚«ãƒ†ã‚´ãƒªå®šç¾©
    // ======================
    const CATEGORY_LABELS = {
      all: "ã™ã¹ã¦",
      jpop: "J-POP / Ado / å‚˜æ‘ / Kanaria ãªã©",
      anime: "ã‚¢ãƒ‹ã‚½ãƒ³ / ã‚²ãƒ¼ã‚½ãƒ³",
      vocaloid: "ãƒœã‚«ãƒ­",
      other: "ãã®ä»–",
      ng: "äºŒåº¦ã¨æ­Œã„ãŸããªã„ã‚„ã¤",
      training: "é ‘å¼µã£ã¦è¦šãˆã¦ã‚‹ã‚„ã¤"
    };

    const CATEGORY_ORDER = ["jpop", "anime", "vocaloid", "other", "ng", "training"];

    let allSongs = [];
    let filteredCategory = "all";
    let keyword = "";

    const sectionsContainer = document.getElementById("songSections");
    const searchInput = document.getElementById("searchInput");
    const filterRow = document.getElementById("filterRow");

    // ======================
    // æ›´æ–°æ—¥è¡¨ç¤º
    // ======================
    (function setUpdatedDate() {
      const updatedSpan = document.getElementById("updatedDate");
      const today = new Date();
      const y = today.getFullYear();
      const m = String(today.getMonth() + 1).padStart(2, "0");
      const d = String(today.getDate()).padStart(2, "0");
      updatedSpan.textContent = `${y}/${m}/${d}`;
    })();

    // ======================
    // songs.json èª­ã¿è¾¼ã¿
    // ======================
    async function loadSongs() {
      try {
        const res = await fetch("songs.json", { cache: "no-store" });
        if (!res.ok) {
          throw new Error("songs.json ãŒèª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ");
        }
        const data = await res.json();
        allSongs = Array.isArray(data) ? data : [];
        buildFilterButtons();
        render();
      } catch (err) {
        console.error(err);
        sectionsContainer.innerHTML =
          '<p class="empty-msg">æ›²ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>';
      }
    }

    // ======================
    // ãƒ•ã‚£ãƒ«ã‚¿ãƒœã‚¿ãƒ³ç”Ÿæˆ
    // ======================
    function buildFilterButtons() {
      // ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®æ›²æ•°
      const counts = allSongs.reduce(
        (acc, song) => {
          const cat = song.category || "other";
          acc.all++;
          acc[cat] = (acc[cat] || 0) + 1;
          return acc;
        },
        { all: 0 }
      );

      const cats = ["all", ...CATEGORY_ORDER];

      filterRow.innerHTML = "";
      cats.forEach((key) => {
        const btn = document.createElement("button");
        btn.className = "filter-btn" + (key === filteredCategory ? " active" : "");
        btn.dataset.category = key;
        btn.textContent = CATEGORY_LABELS[key] || key;
        const countSpan = document.createElement("span");
        countSpan.className = "count";
        countSpan.textContent = counts[key] != null ? counts[key] : 0;
        btn.appendChild(countSpan);

        btn.addEventListener("click", () => {
          filteredCategory = key;
          document
            .querySelectorAll(".filter-btn")
            .forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          render();
        });

        filterRow.appendChild(btn);
      });
    }

    // ======================
    // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    // ======================
    function render() {
      const kw = keyword.toLowerCase().trim();
      let songsToShow = allSongs.slice();

      // ã‚«ãƒ†ã‚´ãƒªçµã‚Šè¾¼ã¿
      if (filteredCategory !== "all") {
        songsToShow = songsToShow.filter(
          (s) => (s.category || "other") === filteredCategory
        );
      }

      // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢
      if (kw) {
        songsToShow = songsToShow.filter((s) => {
          const t = (s.title || "").toLowerCase();
          const a = (s.artist || "").toLowerCase();
          const m = (s.memo || "").toLowerCase();
          return `${t} ${a} ${m}`.includes(kw);
        });
      }

      if (songsToShow.length === 0) {
        sectionsContainer.innerHTML =
          '<p class="empty-msg">æ¡ä»¶ã«åˆã†æ›²ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚„ã‚«ãƒ†ã‚´ãƒªã‚’å¤‰ãˆã¦ã¿ã¦ãã ã•ã„ã€‚</p>';
        return;
      }

      // ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°
      const groups = {};
      songsToShow.forEach((s) => {
        const cat = s.category || "other";
        if (!groups[cat]) groups[cat] = [];
        groups[cat].push(s);
      });

      // ã„ã„æ„Ÿã˜ã®é †ç•ªã§ä¸¦ã¹ã‚‹
      const order = CATEGORY_ORDER.filter((c) => groups[c]);
      const htmlParts = [];

      order.forEach((cat) => {
        const list = groups[cat];
        htmlParts.push(renderCategorySection(cat, list));
      });

      sectionsContainer.innerHTML = htmlParts.join("");
    }

    function renderCategorySection(catKey, songs) {
      const label =
        catKey === "jpop"
          ? "J-POP / Ado / å‚˜æ‘ãƒˆãƒ¼ã‚¿ / Kanaria ãªã©"
          : catKey === "anime"
          ? "ã‚¢ãƒ‹ã‚½ãƒ³ / ã‚²ãƒ¼ã‚½ãƒ³"
          : catKey === "vocaloid"
          ? "ãƒœã‚«ãƒ­"
          : catKey === "ng"
          ? "äºŒåº¦ã¨æ­Œã„ãŸããªã„ã‚„ã¤"
          : catKey === "training"
          ? "é ‘å¼µã£ã¦è¦šãˆã¦ã‚‹ã‚„ã¤"
          : "ãã®ä»–";

      const headerTitle =
        {
          jpop: "J-POP / ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆç³»",
          anime: "ã‚¢ãƒ‹ã‚½ãƒ³ / ã‚²ãƒ¼ãƒ ã‚½ãƒ³ã‚°",
          vocaloid: "ãƒœã‚«ãƒ­",
          other: "ãã®ä»–",
          ng: "NGãƒªã‚¹ãƒˆï¼ˆæ­Œã„ãŸããªã„ï¼‰",
          training: "ç·´ç¿’ä¸­ã®æ›²"
        }[catKey] || "ãã®ä»–";

      const rowsHtml = songs
        .map((s) => {
          const title = escapeHtml(s.title || "");
          const artist = escapeHtml(s.artist || "");
          const memo = s.memo || "";

          const memoPills = [];

          if (/äºŒåº¦ã¨æ­Œã„ãŸããªã„/.test(memo)) {
            memoPills.push(
              `<span class="memo-pill memo-ng">äºŒåº¦ã¨æ­Œã„ãŸããªã„</span>`
            );
          }
          if (/ç·´ç¿’ä¸­/.test(memo)) {
            memoPills.push(
              `<span class="memo-pill memo-training">ç·´ç¿’ä¸­</span>`
            );
          }
          if (/[-+]\d|\/\d{2}/.test(memo)) {
            memoPills.push(
              `<span class="memo-pill memo-key">ã‚­ãƒ¼æƒ…å ±ã‚ã‚Š</span>`
            );
          }

          const memoText = memo
            ? `<div class="memo-text">${escapeHtml(memo)}</div>`
            : "";

          return `
          <tr>
            <td>
              <div class="song-title">${title}</div>
            </td>
            <td>
              <div class="song-artist">${artist || "&nbsp;"}</div>
            </td>
            <td>
              ${memoPills.join(" ")}
              ${memoText}
            </td>
          </tr>
        `;
        })
        .join("");

      return `
      <section class="category-section" data-category="${catKey}">
        <div class="category-header">
          <h2 class="category-title">${headerTitle}</h2>
          <span class="category-badge">${label}</span>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>æ›²å</th>
                <th>ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ</th>
                <th>ãƒ¡ãƒ¢</th>
              </tr>
            </thead>
            <tbody>
              ${rowsHtml}
            </tbody>
          </table>
        </div>
      </section>
    `;
    }

    function escapeHtml(str) {
      return String(str)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    // ======================
    // ã‚¤ãƒ™ãƒ³ãƒˆ
    // ======================
    searchInput.addEventListener("input", (e) => {
      keyword = e.target.value;
      render();
    });

    // åˆæœŸãƒ­ãƒ¼ãƒ‰
    loadSongs();
  </script>
</body>
</html>
